// TODO implement the space optimised approach